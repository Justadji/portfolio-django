{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container my-5">
  
  <h2 class="text-center mb-4">Galerie des œuvres</h2>

  <!-- Liste déroulante de filtres -->
<select name="categorie">
  <option value="">Toutes les catégories</option>
  {% for cat in categories %}
    <option value="{{ cat.nom }}">{{ cat.nom }}</option>
  {% endfor %}
</select>


  <!-- Grille des œuvres -->
  <div class="row" id="oeuvresContainer">
    {% for oeuvre in oeuvres %}
      <div class="col-md-4 mb-4 oeuvre" data-categorie="{{ oeuvre.categorie.nom|slugify }}">
        <div class="card h-100 shadow">
          <img src="{{ oeuvre.image.url }}" class="card-img-top" alt="{{ oeuvre.titre }}">
          <div class="card-body">
            <h5 class="card-title">{{ oeuvre.titre }}</h5>
            <p class="card-text">{{ oeuvre.description|truncatewords:12 }}</p>
          </div>
        </div>
      </div>
    {% empty %}
      <p class="text-center">Aucune œuvre trouvée.</p>
    {% endfor %}
  </div>
</div>

<!-- Script de filtrage -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const select = document.getElementById("categorieSelect");
    const oeuvres = document.querySelectorAll(".oeuvre");

    select.addEventListener("change", function () {
      const selected = this.value;

      oeuvres.forEach(function (oeuvre) {
        const cat = oeuvre.getAttribute("data-categorie");
        if (selected === "all" || selected === cat) {
          oeuvre.style.display = "block";
        } else {
          oeuvre.style.display = "none";
        }
      });
    });
  });
</script>
{% endblock %}